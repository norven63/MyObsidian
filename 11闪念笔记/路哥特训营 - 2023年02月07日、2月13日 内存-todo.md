日期： 2023-01-05

标签： #学习笔记 #技术

学习资料： 


---
<br>

2月7日
leakcanary
ActivityManager.MemoryInfo()
Runtime.getRuntime() //java内存
Debug.MemoryInfo()、AppMemory() //native内存
Runtime.gc()、System.runFinalization() //双重gc，保证执行成功率
Malloc Debug
mm_struct 整个地址空间、vm_area_struct 虚拟地址空间
[android_os_Debug.cpp](http://aospxref.com/android-10.0.0_r47/xref/frameworks/base/core/jni/android_os_Debug.cpp)
PSS：实际使用的物理内存
RSS：，不准、偏高，Android.LowMemoryKiller根据RSS来计算
虚拟内存映射、mmap

2月13日
Koom的unwind库，栈回溯

泄漏：
- C++(4个函数)Xhook
- Java的4大引用，GCRoot，SofrtRef、WeakRef->判断对象是否回收

指标（采集瞬时的内存暴增、TotalMem的80%）

监控方案
 - thread
 - fd：cd /proc/self/fd、连续3次检测，如果>1000 -> 有问题
 - 泄漏

内存的监测策略：子进程内存的Dump（不阻塞主进程）->shark库

Linux内核——CMA
- /proc/self/status 
- /proc/meminfo：MemTotal、MemFree、MemAvailable、CmaTotal、ION_heap