日期： 2022-11-22

标签： #学习笔记 #技术

学习资料： 
https://iww0abxi5u.feishu.cn/minutes/obcnq9v699489uhbj1614lq4

---
<br>

2. android.os.Debug
3. Linux 内核调度全景图: https://makelinux.github.io/kernel/map/
	1. memory
4. [大佬博客](https://brendangregg.com/)
5. 锁
	1. 互斥锁
		1. 同一个时间分片，只能有一个线程持有该锁
	2. 自旋锁
		1. 当等待一个短耗时任务锁时，没必要让CPU频繁切换线程上下文，就可以通过自旋锁持续占住CPU分片，减少开销。但是因为一直占住CPU，所以不适合在等待长耗时任务锁
		2. spinlock_t、volatile
	3. 信号量：
		1. 本质是一个技术器，如果初始值为1，那么此为二元信号量
		2. P/V操作；P申请，计数器-1；V释放，计数器+1
		3. POSIX信号量
		4. 有名信号量、无名信号量
		5. 匿名共享内存，匿名信号量，内存块里找对应地址的文件，a map机制 把文件映射到内存的一个地址空间
		6. 有名信号量由 `sem_open` 打开，`sem_unlink` 删除；无名信号量由 `sem_init` 打开，`sem_destroy` 删除
		7. 有名信号量进程之间使用；无名信号量线程之间使用，也可以搭建共享内存在进程之间使用
<br><br>

### Ftrace
1. mount | grep debugs
2. echo function_graph > current_tracer
<br>

#### trace-cmd
apt install trace-cmd

### /art/runtime/trace文件
堆栈信息：
[/art/runtime/backtrace_helper.h](http://aospxref.com/android-11.0.0_r21/xref/art/runtime/backtrace_helper.h)
[/art/runtime/backtrace_helper.cc](http://aospxref.com/android-11.0.0_r21/xref/art/runtime/backtrace_helper.cc)

[/art/runtime/trace.h](http://aospxref.com/android-11.0.0_r21/xref/art/runtime/trace.h)
- TraceMode：跟踪模式
	- kMethodTracing 插桩
	- kSampling 采样
- [android.os.Debug](http://aospxref.com/android-11.0.0_r21/xref/frameworks/base/core/java/android/os/Debug.java).startMethodTracing()

[/art/runtime/trace.cc](http://aospxref.com/android-11.0.0_r21/xref/art/runtime/trace.cc)
// Create Trace object.
new Trace
==**StackVisitor**==
WalkStack
TraceLogMethodTraceEvent
