日期： 2022-04-16

标签： #学习笔记 #技术 #Android 

学习资料： 
腾讯课堂 - https://ke.qq.com/webcourse/3060320/105200059#taid=13820947063550560&vid=387702298740005737

百度网盘 - https://pan.baidu.com/disk/main?from=homeFlow#/index?category=all&path=%2F%E5%AD%A6%E4%B9%A0%2F%E4%BA%AB%E5%AD%A6VIP%E8%AF%BE%E7%A8%8B%2F2%E6%9C%9F%2F%E3%80%9007%E3%80%91NDK%2F%EF%BC%8803%EF%BC%892021.2.28%20%E9%9D%99%E6%80%81%E5%BC%80%E8%BE%9F%E5%86%85%E5%AD%98%E4%B8%8E%E5%8A%A8%E6%80%81%E5%BC%80%E8%BE%9F%E5%86%85%E5%AD%98%EF%BC%88NDK%E7%AC%AC%E4%B8%89%E8%8A%82%E8%AF%BE%EF%BC%89%20---derry%E8%80%81%E5%B8%88

---
<br>

> ==**C的开发中不允许出现，野指针，悬空指针**==
> **野指针**：`int* p;` 这种声明后，没有赋值的空指针
> **悬空指针**：内存被执行 `free()` 释放后，指针没有被复制给 `NULL` 的指针

<br>


### 一、静态开辟
- 函数开始执行，即为该函数压入栈内存，函数执行结束，即为该函数弹出栈内存
- 每个函数 **压入** 栈内存后，都会被分配一个独立的栈空间，大小约 2M 左右（与平台有关）
- 函数 **弹出** 栈内存后，系统会 **自动清空** 回收它的栈空间（栈成员占用的总大小）
- 在函数里声明定义局部变量的操作，属于 **静态开辟** 的范畴，会占用栈空间大小。如果声明的局部变量大小占用的内存空间超出了系统分配的2M，就会抛 **栈溢出** 错误

```C
#include <stdio.h>
#include <unistd.h> // 小写的sleep，大写的Sleep用<windows.h>

// 静态开辟的范畴：函数进栈后，在函数中声明定义一个局部变量，例如 int arr[5];、int i;

// staticAction()函数压栈
void staticAction() {
	int arr[5]; // 静态开辟 栈区（栈成员）

	for (int i = 0; i < 5; ++i) {
		arr[i] = i;
		printf("%d, %p\n", *(arr + i), arr + i);
	}
}
// staticAction()函数弹栈（隐式），并释放所有的栈成员

// 2.静态开辟。
int mainT3() {
	// int arr[10 * 1024 * 1024]; // 10M * 4 = 40M  会抛 栈溢出 错误
	int arr[(int)(1 * 1 * 1024)]; //  不会栈溢出

	// 栈区：占用内存大小 最大值： 大概 2M  大于2M会栈溢出  平台有关系的
	// 堆区：占用内存大小 最大值： 大概80%  40M没有任何问题，基本上不用担心 堆区很大的
							   // 大概80%： Windows系统 给我们的编译器给予的空间  的 百分之百八十

	while (9) {
		Sleep(100);
		staticAction(); // staticAction()每次调用会开辟20个字节栈内存
	}

	return (0);
}
```

<br>

### 二、动态开辟
##### 1、malloc

##### 2、realloc